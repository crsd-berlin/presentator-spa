(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dd234702"],{"1efe":function(e,t,s){"use strict";s.d(t,"a",function(){return r});var i=s("9242"),o=s("9300"),a=s("dd93");class r extends i["a"]{load(e){e=e||{},super.load(e),this.projectId=a["a"].isEmpty(e.projectId)?null:e.projectId,this.order=a["a"].isEmpty(e.order)?1:e.order<<0,this.title=a["a"].isEmpty(e.title)?"":e.title,this.description=a["a"].isEmpty(e.description)?"":e.description,a["a"].isArray(e.assets)?this.assets=o["a"].createInstances(e.assets):this.assets=this.assets||[]}}},9300:function(e,t,s){"use strict";s.d(t,"a",function(){return r});s("28a5");var i=s("9242"),o=s("dd93");const a=["png","jpg","jpeg","svg","bmp"];class r extends i["a"]{load(e){e=e||{},super.load(e),this.guidelineSectionId=o["a"].isEmpty(e.guidelineSectionId)?null:e.guidelineSectionId,this.type=o["a"].isEmpty(e.type)?"file":e.type,this.order=o["a"].isEmpty(e.order)?1:e.order,this.hex=o["a"].isEmpty(e.hex)?"":e.hex,this.title=o["a"].isEmpty(e.title)?"":e.title,this.file=o["a"].isEmpty(e.file)?{}:e.file}get isFile(){return"file"===this.type}get isColor(){return"color"===this.type}get contrastHex(){return this.isColor?o["a"].getContrastHex(this.hex):""}get rgb(){return o["a"].hexToRgb(this.hex)}get fileExtension(){return this.isFile&&this.file.original?this.file.original.split(".").pop():""}get isImage(){return this.isFile&&this.file.original&&a.indexOf(this.fileExtension)>=0}getFileUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"original";return this.file[e]||this.file["original"]||""}}},"9c86":function(e,t,s){"use strict";s.d(t,"a",function(){return a});var i=s("9242"),o=s("dd93");class a extends i["a"]{load(e){e=e||{},super.load(e),this.title=o["a"].isEmpty(e.title)?"":e.title,this.archived=o["a"].isEmpty(e.archived)?0:e.archived<<0,this.featuredScreen=o["a"].isEmpty(e.featuredScreen)?{}:e.featuredScreen}getFeaturedScreen(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"original";return this.featuredScreen[e]||this.featuredScreen["original"]||""}get isArchived(){return!!this.archived}}},ae26:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"guideline-section"},[s("header",{staticClass:"section-header"},[s("h5",{staticClass:"title"},[e._v(e._s(e.section.title))]),e.section.description?[e._v("\n            ("),s("div",{staticClass:"description"},[e._v(e._s(e.section.description))]),e._v(")\n        ")]:e._e(),s("div",{staticClass:"flex-fill-block"}),s("div",{staticClass:"ctrl-item toggle-ctrl",on:{click:function(t){return t.preventDefault(),e.toggleSection()}}},[e.collapsed?[s("span",{staticClass:"txt m-r-5 txt-default"},[e._v(e._s(e.$t("Expand")))]),s("i",{staticClass:"fe fe-chevron-down"})]:[s("span",{staticClass:"txt m-r-5"},[e._v(e._s(e.$t("Collapse")))]),s("i",{staticClass:"fe fe-chevron-up"})]],2)],2),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.collapsed,expression:"!collapsed"}],staticClass:"section-content"},[s("div",{staticClass:"boxes-list assets-list"},e._l(e.orderedAssets,function(e){return s("asset-box-preview",{key:e.id,attrs:{asset:e}})}),1)])])},o=[],a=(s("55dd"),s("dd93")),r=s("1efe"),n=s("9300"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"box box-card box-compact",class:{"box-color":e.asset.isColor},on:{mouseleave:function(t){!e.$refs.assetDropdown||e.$refs.assetDropdown.hide()}}},[s("figure",{staticClass:"box-thumb",style:{background:e.asset.hex}},[e.asset.isFile?[s("div",{staticClass:"crop-wrapper"},[e.asset.isImage?s("img",{staticClass:"img",attrs:{src:e.asset.getFileUrl("medium"),alt:e.asset.title}}):s("span",{staticClass:"img img-alt"},[e._v(e._s(e.asset.fileExtension))])])]:e._e(),s("div",{staticClass:"thumb-overlay"},[s("div",{staticClass:"box-ctrl handle top-right"},[s("i",{staticClass:"fe fe-more-horizontal",style:{color:e.asset.isColor?e.asset.contrastHex:null}}),s("toggler",{ref:"assetDropdown",staticClass:"dropdown dropdown-sm"},[e.asset.isFile?s("a",{staticClass:"dropdown-item",attrs:{href:e.asset.getFileUrl(),tabindex:"-1",download:"",target:"_blank",rel:"noopener"}},[s("i",{staticClass:"fe fe-download"}),s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Download")))])]):e._e(),e.asset.isColor?s("div",{staticClass:"dropdown-item",on:{click:function(t){t.preventDefault(),e.copyToClipboard(e.asset.hex.toUpperCase())}}},[s("i",{staticClass:"fe fe-copy"}),s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Copy HEX")))])]):e._e()])],1)])],2),s("div",{staticClass:"box-content"},[e.asset.isFile?[s("a",{staticClass:"title",attrs:{target:"_blank",rel:"noopener",href:e.asset.getFileUrl(),title:e.$t("Open in new tab")}},[e._v(e._s(e.asset.title))]),s("div",{staticClass:"meta"},[s("div",{staticClass:"meta-item txt-uppercase"},[e._v(e._s(e.asset.fileExtension))]),e.asset.isImage&&e.assetWidth>0&&e.assetHeight>0?s("div",{staticClass:"meta-item"},[e._v("\n                    "+e._s(e.assetWidth)+"x"+e._s(e.assetHeight)+"\n                ")]):e._e()])]:[s("div",{staticClass:"title txt-uppercase",attrs:{title:e.$t("Copy to clipboard")},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.copyToClipboard(e.asset.hex.toUpperCase())}}},[e._v(e._s(e.asset.hex))]),s("div",{staticClass:"meta"},[s("div",{staticClass:"meta-item"},[e._v("rgb("+e._s(e.asset.rgb.r)+", "+e._s(e.asset.rgb.g)+", "+e._s(e.asset.rgb.b)+")")])])]],2)])},l=[],p={name:"asset-box-preview",props:{asset:{type:n["a"],required:!0}},data(){return{assetWidth:0,assetHeight:0}},mounted(){this.asset.isImage&&a["a"].loadImage(this.asset.getFileUrl()).then(e=>{this.assetWidth=e.width,this.assetHeight=e.height})},methods:{copyToClipboard(e){a["a"].copyToClipboard(e)?this.$toast(this.$t("Successfully copied {text} to clipboard.",{text:e})):this.$toast(this.$t("Failed copying {text} to clipboard.",{text:e}),"danger")}}},d=p,m=s("2877"),h=Object(m["a"])(d,c,l,!1,null,null,null),u=h.exports,v={name:"guideline-section-preview",props:{section:{type:r["a"],required:!0}},components:{"asset-box-preview":u},data(){return{collapsed:!1}},computed:{orderedAssets(){return this.section.assets.slice().sort((e,t)=>e["order"]-t["order"])}},methods:{toggleSection(){this.collapsed=!this.collapsed}}},g=v,f=Object(m["a"])(g,i,o,!1,null,null,null);t["a"]=f.exports},ba5d:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var i=s("9242"),o=s("72a1"),a=s("dd93");class r extends i["a"]{load(e){e=e||{},super.load(e),this.projectId=a["a"].isEmpty(e.projectId)?null:e.projectId,this.slug=a["a"].isEmpty(e.slug)?"":e.slug,this.passwordProtected=!!e.passwordProtected,this.allowComments=!!e.allowComments,this.allowGuideline=!!e.allowGuideline,a["a"].isArray(e.prototypes)?this.prototypes=o["a"].createInstances(e.prototypes):this.prototypes=this.prototypes||[]}get baseUrl(){var e=a["a"].getNestedVal(window,"location.origin","");return a["a"].getNestedVal(window,"location.href","").indexOf("/#/")>0&&(e+="/#"),e=e.endsWith("/")?e.substring(0,e.length-1):e,e}get fullUrl(){return this.baseUrl+"/"+this.slug}get prototypeIds(){var e=[];for(let t in this.prototypes)this.prototypes[t].id&&e.push(this.prototypes[t].id);return e}}},db9e:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("nav",{staticClass:"floating-bar preview-bar",class:{active:e.isActive}},[s("div",{staticClass:"visibility-toggle",on:{click:function(t){return t.preventDefault(),e.toggle()}}},[s("span",{staticClass:"txt"},[e._v(e._s(e.isActive?e.$t("Hide"):e.$t("Show")))])]),s("div",{staticClass:"nav nav-left"},[e._t("left")],2),s("div",{staticClass:"nav nav-center"},[e.projectLink.allowGuideline?s("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Guideline (G)"),expression:"$t('Guideline (G)')",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.71",value:e.selfClick,expression:"selfClick",modifiers:{71:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-warning",attrs:{to:{name:"preview-guideline",params:{slug:e.projectLink.slug},query:{}},"active-class":"highlight"}},[s("i",{staticClass:"fe fe-book-open"})]):e._e(),s("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Preview mode (P)"),expression:"$t('Preview mode (P)')",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.80",value:e.selfClick,expression:"selfClick",modifiers:{80:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-success",attrs:{to:{name:"preview-prototype",params:Object.assign({},e.$route.params,{slug:e.projectLink.slug,prototypeId:e.activePrototypeId}),query:Object.assign({},e.$route.query,{mode:"preview"})},"exact-active-class":"highlight"}},[s("i",{staticClass:"fe fe-eye"})]),e.projectLink.allowComments?s("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Comments mode (C)"),expression:"$t('Comments mode (C)')",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.67",value:e.selfClick,expression:"selfClick",modifiers:{67:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-danger",attrs:{to:{name:"preview-prototype",params:Object.assign({},e.$route.params,{slug:e.projectLink.slug,prototypeId:e.activePrototypeId}),query:Object.assign({},e.$route.query,{mode:"comments"})},"exact-active-class":"highlight"}},[e.activeUnreadComments.length?s("span",{staticClass:"beacon beacon-danger"}):e._e(),s("i",{staticClass:"fe fe-message-circle"})]):e._e()],1),s("div",{staticClass:"nav nav-right"},[e._t("right"),s("div",{staticClass:"ctrl-item ctrl-item-circle ctrl-item-settings"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Preview info"),expression:"$t('Preview info')",modifiers:{top:!0}}]},[s("i",{staticClass:"fe fe-info"})]),s("preview-info-popover",{ref:"projectInfoPopover",staticClass:"transform-bottom-right",attrs:{project:e.project}})],1)],2)])},o=[],a=(s("ac6a"),s("ade3")),r=s("2f62"),n=s("0abc"),c=s("3d48"),l=s("9c86"),p=s("ba5d"),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("toggler",{staticClass:"popover popover-sm preview-info-popover",attrs:{hideOnChildClick:!1}},[s("div",{staticClass:"content m-b-small txt-center"},[s("p",[s("strong",[e._v(e._s(e.project.title))])]),e.$getAppConfig("VUE_APP_PROJECT_URL")?s("p",{staticClass:"txt-hint txt-small"},[s("i18n",{attrs:{path:"Presented with {projectLink}."}},[s("a",{attrs:{place:"projectLink",href:e.$getAppConfig("VUE_APP_PROJECT_URL"),target:"_blank",rel:"noopener"}},[e._v("Presentator")])])],1):e._e(),s("div",{staticClass:"clearfix m-t-small"}),s("language-select")],1)])},m=[],h=s("f7ef"),u={name:"preview-info-popover",components:{"language-select":h["a"]},props:{project:{type:l["a"],required:!0}}},v=u,g=s("2877"),f=Object(g["a"])(v,d,m,!1,null,null,null),C=f.exports;function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function w(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(s,!0).forEach(function(t){Object(a["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}var b={name:"preview-bar",components:{"preview-info-popover":C},props:{project:{type:l["a"],required:!0},projectLink:{type:p["a"],required:!0}},data(){return{isActive:!0}},computed:w({},Object(r["d"])({activePrototypeId:e=>e.prototypes.activePrototypeId,activeScreenId:e=>e.screens.activeScreenId}),{},Object(r["c"])({getUnreadCommentsForScreen:"notifications/getUnreadCommentsForScreen"}),{activeUnreadComments(){return this.getUnreadCommentsForScreen(this.activeScreenId)}}),mounted(){var e=c["a"].getItem(n["a"].get("VUE_APP_PREVIEW_BAR_VISIBLITY_STORAGE_KEY"),!0);e?this.show():this.hide()},methods:{show(){this.isActive=!0,c["a"].setItem(n["a"].get("VUE_APP_PREVIEW_BAR_VISIBLITY_STORAGE_KEY"),!0),this.$emit("show")},hide(){this.isActive=!1,c["a"].setItem(n["a"].get("VUE_APP_PREVIEW_BAR_VISIBLITY_STORAGE_KEY"),!1),this.$emit("hide")},toggle(){this.isActive?this.hide():this.show()},goToGuideline(){this.$router.push({name:"preview-guideline",params:{slug:this.projectLink.slug}})},selfClick(e,t){t&&t.click()}}},_=b,P=Object(g["a"])(_,i,o,!1,null,null,null);t["a"]=P.exports},f7ef:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"languages-select",class:{loading:e.isChanging}},[s("div",{staticClass:"selected-language"},[s("span",{staticClass:"txt language-title"},[e._v(e._s(e.activeLanguageTitle))]),e._v("\n        ("),s("span",{staticClass:"txt language-code"},[e._v(e._s(e.activeLanguageCode))]),e._v(")\n    ")]),s("toggler",{staticClass:"dropdown dropdown-sm"},e._l(e.languages,function(t,i){return s("div",{key:"language_"+i,staticClass:"dropdown-item",class:{active:e.activeLanguageCode==i},on:{click:function(t){return t.preventDefault(),e.changeLanguage(i)}}},[s("small",{staticClass:"label language-code m-r-5",class:e.activeLanguageCode==i?"label-transp-primary":"label-light-border"},[e._v(e._s(i))]),s("span",{staticClass:"txt language-title"},[e._v(e._s(t))])])}),0)],1)},o=[],a=(s("097d"),s("9225")),r={name:"languages-select",data(){return{isChanging:!1,languages:Object.assign({},a["c"])}},watch:{"$i18n.locale":function(e,t){"function"===typeof document._titleFunc&&this.$setDocumentTitle(document._titleFunc)}},computed:{activeLanguageCode(){return this.$i18n.locale},activeLanguageTitle(){return this.languages[this.activeLanguageCode]}},methods:{changeLanguage(e){this.isChanging=!0,Object(a["a"])(e).finally(()=>{this.isChanging=!1})}}},n=r,c=s("2877"),l=Object(c["a"])(n,i,o,!1,null,null,null);t["a"]=l.exports},fb7f:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"preview-container",class:{"comments-mode":e.isInCommentsMode,"preview-mode":e.isInPreviewMode,"preview-mode-hints":e.isPreviewModeHintsActive},style:{background:e.activePrototype&&e.activeScreen&&e.activePrototype.isForDesktop?e.activeScreen.background:null},attrs:{tabindex:"-1"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.onEscPress(t)}}},[s("div",{staticClass:"flex-fill-block"}),s("comment-popover",{ref:"commentPopover",attrs:{isForPreview:!0,mentionsList:e.mentionsList},on:{closed:e.onCommentPopoverClose}}),e.isLoadingData?s("div",{staticClass:"block txt-center"},[s("span",{staticClass:"loader loader-lg loader-blend"})]):e._e(),e.isLoadingData||e.screens.length?e._e():s("div",{staticClass:"block scroll-block txt-center p-base"},[e._m(0),s("h4",[e._v(e._s(e.$t("No prototype screens to show.")))])]),!e.isLoadingData&&e.screens.length?s("screen-preview",{ref:"screenPreview",attrs:{interactions:e.isInPreviewMode,activeScreenTooltip:e.modeHelpTooltip},on:{activeScreenClick:e.onActiveScreenClick}},[e.isInCommentsMode?s("div",{staticClass:"block comments-block"},e._l(e.activeScreenComments,function(t){return s("comment-pin",{key:"comment_"+t.id,ref:"screenCommentPins",refInFor:!0,class:{"soft-hidden":!e.showResolvedComments&&t.isResolved,unread:e.isCommentUnread(t.id)},attrs:{comment:t,allowPositionChange:!1},on:{beforeActivate:e.onCommentActivate}})}),1):e._e()]):e._e(),s("div",{staticClass:"flex-fill-block"}),s("preview-bar",{attrs:{project:e.project,projectLink:e.projectLink},on:{hide:function(t){!e.$refs.screensPanel||e.$refs.screensPanel.hide()}},scopedSlots:e._u([{key:"left",fn:function(){return[e.activeScreen&&e.$refs.screensPanel?s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$refs.screensPanel.isActive?e.$t("Hide screens panel"):e.$t("Show screens panel"),expression:"$refs.screensPanel.isActive ? $t('Hide screens panel') : $t('Show screens panel')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-screens",class:{active:e.$refs.screensPanel.isActive},on:{click:function(t){return t.preventDefault(),e.$refs.screensPanel.toggle()}}},[s("span",{staticClass:"txt screen-title"},[e._v(e._s(e.activeScreen.title))]),s("span",{staticClass:"txt counter m-l-5"},[e._v("("+e._s(e.activeScreenOrderedIndex+1)+" of "+e._s(e.screens.length)+")")]),s("i",{staticClass:"m-l-5 fe",class:e.$refs.screensPanel.isActive?"fe-chevron-up":"fe-chevron-down"})]):e._e()]},proxy:!0},{key:"right",fn:function(){return[e.isInCommentsMode&&e.totalActiveScreenComments>0?s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.showResolvedComments,expression:"showResolvedComments"}],attrs:{type:"checkbox",id:"toggle_resolved_comments"},domProps:{checked:Array.isArray(e.showResolvedComments)?e._i(e.showResolvedComments,null)>-1:e.showResolvedComments},on:{change:function(t){var s=e.showResolvedComments,i=t.target,o=!!i.checked;if(Array.isArray(s)){var a=null,r=e._i(s,a);i.checked?r<0&&(e.showResolvedComments=s.concat([a])):r>-1&&(e.showResolvedComments=s.slice(0,r).concat(s.slice(r+1)))}else e.showResolvedComments=o}}}),s("label",{attrs:{for:"toggle_resolved_comments"}},[e._v("\n                    "+e._s(e.$t("Show resolved comments"))+"\n                    ("+e._s(e.$t("{current} of {total}",{current:e.totalActiveScreenResolvedComments,total:e.totalActiveScreenComments}))+")\n                ")])]):e._e(),e.prototypes.length>1?s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$refs.prototypesDropdown&&e.$refs.prototypesDropdown.isActive?"":e.$t("Change prototype"),expression:"!$refs.prototypesDropdown || !$refs.prototypesDropdown.isActive ? $t('Change prototype') : ''",modifiers:{top:!0}}],staticClass:"btn btn-sm btn-default m-l-small"},[s("i",{staticClass:"fe",class:e.activePrototype.isForDesktop?"fe-monitor":"fe-smartphone"}),s("span",{staticClass:"txt title m-l-5 m-r-5"},[e._v(e._s(e.activePrototype.title))]),s("i",{staticClass:"fe",class:e.$refs.prototypesDropdown&&e.$refs.prototypesDropdown.isActive?"fe-chevron-up":"fe-chevron-down"}),s("toggler",{ref:"prototypesDropdown",staticClass:"dropdown"},e._l(e.prototypes,function(t){return s("div",{key:t.id,staticClass:"dropdown-item",class:{active:e.activePrototype.id==t.id},on:{click:function(s){return s.preventDefault(),e.setActivePrototypeId(t.id)}}},[s("i",{staticClass:"fe",class:t.isForDesktop?"fe-monitor":"fe-smartphone"}),s("span",{staticClass:"txt"},[e._v(e._s(t.title))])])}),0)],1):e._e()]},proxy:!0}])}),s("screens-panel",{ref:"screensPanel"})],1)},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("figure",{staticClass:"mockup m-b-small"},[s("div",{staticClass:"mockup-bg"}),s("div",{staticClass:"browser secondary"}),s("div",{staticClass:"browser primary"},[s("i",{staticClass:"fe fe-image"})])])}],a=(s("a481"),s("ac6a"),s("097d"),s("ade3")),r=s("2f62"),n=s("c1df"),c=s.n(n),l=s("0abc"),p=s("f744"),d=s("dd93"),m=s("3d48"),h=s("9c86"),u=s("ba5d"),v=(s("1efe"),s("46a0")),g=s("0372"),f=s("9aaf"),C=s("7bbf"),y=s("af83"),w=s("c647"),b=s("35bb"),_=s("ae26"),P=s("db9e");function I(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function $(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?I(s,!0).forEach(function(t){Object(a["a"])(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):I(s).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}const x="preview",k="comments";let O=null;var j={name:"screens-view",mixins:[w["a"],b["a"]],props:{project:{type:h["a"],required:!0},collaborators:{type:Array,required:!0},projectLink:{type:u["a"],required:!0}},components:{"screen-preview":g["a"],"screens-panel":f["a"],"comment-pin":C["a"],"comment-popover":y["a"],"guideline-section-preview":_["a"],"preview-bar":P["a"]},data(){return{isPreviewBarActive:!0,isLoadingData:!1,mode:x}},computed:$({},Object(r["d"])({activePrototypeId:e=>e.prototypes.activePrototypeId,prototypes:e=>e.prototypes.prototypes,screens:e=>e.screens.screens,activeScreenId:e=>e.screens.activeScreenId,previewToken:e=>e.preview.previewToken}),{},Object(r["c"])({activePrototype:"prototypes/activePrototype",getPrototype:"prototypes/getPrototype",activeScreen:"screens/activeScreen",getScreen:"screens/getScreen",activeScreenOrderedIndex:"screens/activeScreenOrderedIndex",getComment:"comments/getComment"}),{isInCommentsMode(){return this.mode===k},isInPreviewMode(){return this.mode===x},modeHelpTooltip(){return this.isInCommentsMode?this.$t("Click to leave a comment"):""}}),watch:{"$route.params.prototypeId":function(e,t){e&&this.getPrototype(e)?e!=this.activePrototypeId&&this.setActivePrototypeId(e):this.updateRoutePrototypeId()},"$route.params.screenId":function(e,t){e!=this.activeScreenId&&this.setActiveScreenId(e)},"$route.query.mode":function(e,t){e===k?this.setCommentsMode():e===x?this.setPreviewMode():"preview-prototype"===this.$route.name&&this.updateRouteMode()},activePrototypeId(e,t){this.init()},activeScreenId(e,t){this.updateRouteScreenId(),this.deactivateComments()}},activated(){this.isLoadingData||this.screens.length||this.$setDocumentTitle(()=>this.$t("{projectTitle} prototypes",{projectTitle:this.project.title}))},beforeMount(){this.$route.query.mode===k?this.setCommentsMode():this.setPreviewMode(),this.init()},methods:$({},Object(r["b"])({setActivePrototypeId:"prototypes/setActivePrototypeId",setScreens:"screens/setScreens",setActiveScreenId:"screens/setActiveScreenId",setHotspotTemplates:"hotspots/setHotspotTemplates",appendHotspots:"hotspots/appendHotspots",setHotspots:"hotspots/setHotspots",addUnreadComment:"notifications/addUnreadComment"}),{init(){this.activePrototypeId&&(this.loadPrototypeData(this.activePrototypeId,this.$route.params.screenId),this.projectLink.allowComments&&(this.loadComments(this.activePrototypeId,1,!0),this.newCommentsListener()),this.mentionsList=this.convertCollaboratorsListToMentionsList(this.collaborators))},loadPrototypeData(e,t){e=e||this.activePrototypeId,t=t||this.activeScreenId,this.isLoadingData=!0,p["a"].Previews.getPrototype(this.previewToken,e).then(e=>{let s=d["a"].getNestedVal(e,"data.screens",[]),i=d["a"].getNestedVal(e,"data.hotspotTemplates",[]);if(this.setScreens(s),this.screens.length>0){this.isLoadingData=!0;let e=[];for(let t in this.screens)e.push(d["a"].loadImage(this.screens[t].getImage()));Promise.all(e).finally(()=>{this.isLoadingData=!1})}this.setHotspots([]);for(let t in s)s[t].hotspots&&this.appendHotspots(s[t].hotspots);this.setHotspotTemplates(i);for(let t in i)i[t].hotspots&&this.appendHotspots(i[t].hotspots);t&&this.getScreen(t)&&this.setActiveScreenId(t),this.$refs.screensPanel&&this.$refs.screensPanel.hide(),this.updateRoutePrototypeId(),this.updateRouteScreenId(),this.updateRouteMode()}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isLoadingData=!1})},updateRoutePrototypeId(){if("preview-prototype"!=this.$route.name)return;let e=this.$route.params.prototypeId;e!=this.activePrototypeId&&this.$router[e?"push":"replace"]({name:this.$route.name,params:Object.assign({},this.$route.params,{prototypeId:this.activePrototypeId,screenId:this.activeScreenId}),query:Object.assign({},this.$route.query)})},updateRouteScreenId(){if("preview-prototype"!=this.$route.name)return;let e=this.$route.params.screenId;e!=this.activeScreenId&&this.$router[e?"push":"replace"]({name:this.$route.name,params:Object.assign({},this.$route.params,{screenId:this.activeScreenId}),query:Object.assign({},this.$route.query)})},updateRouteMode(){let e=this.$route.query.mode;e!=this.mode&&this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params),query:Object.assign({},this.$route.query,{mode:this.mode})})},setCommentsMode(){this.mode=k},setPreviewMode(){this.mode=x},onEscPress(e){this.isInCommentsMode&&(e.preventDefault(),this.deactivateComments())},onActiveScreenClick(e){this.isInPreviewMode?this.blinkPreviewModeHints():this.isInCommentsMode&&this.initCommentCreation(e,this.activeScreenId)},loadLatestPreviewComments(e,t){this.isLoadingComments||(p["a"].enableAutoCancellation(!1),p["a"].Previews.getScreenCommentsList(this.previewToken,1,100,{"search[prototypeId]":e,"search[afterCreatedAt]":t}).then(e=>{var t=v["a"].createInstances(e.data),s=m["a"].getItem(l["a"].get("VUE_APP_PREVIEW_COMMENT_FROM_STORAGE_KEY"));for(let i in t)t[i].from==s||this.getComment(t[i].id)||this.addUnreadComment(t[i])}).catch(e=>{this.$errResponseHandler(e)}))},newCommentsListener(){this.projectLink.allowComments&&l["a"].get("VUE_APP_FIRESTORE_PROJECT_ID")&&l["a"].get("VUE_APP_FIRESTORE_COLLECTION")&&Promise.all([s.e("chunk-4bbebd65"),s.e("chunk-2d0c9af8")]).then(s.t.bind(null,"59ca",7)).then(e=>{Promise.all([s.e("chunk-4bbebd65"),s.e("chunk-3105eb94")]).then(s.bind(null,"e71f")).then(()=>{e.apps.length||e.initializeApp({projectId:l["a"].get("VUE_APP_FIRESTORE_PROJECT_ID")}),"function"===typeof O&&O();var t=e.firestore();O=t.collection(l["a"].get("VUE_APP_FIRESTORE_COLLECTION")).doc("p"+this.project.id).onSnapshot(e=>{var t=e.data()||{},s=t[Object.keys(t)[0]]<<0;if(s&&this.projectLink.allowComments){let e=c.a.utc(s-5,"X").format("YYYY-MM-DD HH:mm:ss");this.loadLatestPreviewComments(this.activePrototypeId,e)}}),this.$once("hook:deactivated",()=>{"function"===typeof O&&O()})})})}})},S=j,E=s("2877"),A=Object(E["a"])(S,i,o,!1,null,null,null);t["default"]=A.exports}}]);